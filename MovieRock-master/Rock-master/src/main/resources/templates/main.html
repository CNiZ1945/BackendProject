<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Park Player</title>
    <link rel="stylesheet" href="/static/css/main.css">
    <link href="https://fonts.googleapis.com/css2?family=Montaga&family=Noto+Sans+KR:wght@100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/all.min.css" integrity="sha512-10/jx2EXwxxWqCLX/hHth/vu2KY3jCF70dCQB8TSgNjbCVAC/8vai53GfMDrO2Emgwccf2pJqxct9ehpzG+MTw==" crossorigin="anonymous" referrerpolicy="no-referrer" />

</head>
<body>
    
    <header>
        <!-- 헤더 오른쪽 -->
        <div class="header_right">
            <div class="logo_img">
                <!-- 로고 이미지 -->
                <a href="movie_search.html"><img src="http://placehold.it/70X70" alt=""></a>
            </div>
        </div>
        <!-- 검색창 -->
        <div class="search">
            <form action="">
                <input type="text" name="" id="" class="search_input" placeholder="오늘은 무슨 영화를 볼까?">
                <button class="search_btn" type="submit">
                    <i class="fa-solid fa-magnifying-glass-arrow-right fa-3x" ></i>
                </button>
            </form>
        </div>
        <!-- 헤더 왼쪽 -->
        <div class="header_left">
    
            <div class="profile">
                <!-- 동그라미 프로필 공간 -->
                <a href="/admin/main"> 임시 <br>관리자 페이지</a>
            </div>
            <div class="profile_menu">
                <ul>
                    <a href="mypage.html"><li>마이페이지</li></a>
                    <a href="notice.html"><li>공지사항</li></a>
                    <a href="login.html"><li>로그인</li></a>
                </ul>
            </div>
                <!-- 추후에 로그인후에 로그아웃으로 바뀌도록 작성 -->
        </div> 
    </header>
    <!--  ========================== header =================================  -->
    <!-- ============================ 영화 랭킹 ============================= -->
    <div class="ranking">
        <div class="slide">
            <div class="slide_page">
                
                    <ul class="slide_ul">
                        <li>
                            <a href="/user/movie">
                            <figure>
                                <img src="/static/img/dune.jpg" alt="" class="img_slide">
                                <figcaption>
                                    <p class="movie_title">듄</p>
                                    <p class="movie_content" >Lorem, ipsum dolor sit amet consectetur adipi. Maiores sapiente la, accusamus officiis at ea quibusdam dignissimos iure voluptatem quas eligendi quaerat nihil, incidunt omnis!</p>
                                    <p class="movie_genre">장르: sf</p>
                                    <p class="movie_time">시간: 120분</p>
                                </figcaption>
                            </figure>
                            </a>
                        </li>
                        <li>
                            <a href="movie_page.html">
                                <figure>
                                    <img src="/static/img/half-life-3-pc-game-cover.jpg" alt="" class="img_slide">
                                    <figcaption>
                                        <p class="movie_title">하프라이프 3</p>
                                        <p class="movie_content" >Lorem, ipsum dolor sit amet consectetur adipi. Maiores sapiente la, accusamus officiis at ea quibusdam dignissimos iure voluptatem quas eligendi quaerat nihil, incidunt omnis!</p>
                                        <p class="movie_genre">장르: sf</p>
                                        <p class="movie_time">시간: 2034년</p>
                                    </figcaption>
                                </figure>

                            </a>
                            
                        </li>
                        <li>
                            <a href="movie_page.html">
                                <figure>
                                    <img src="/static/img/harry.webp" alt="" class="img_slide">
                                    <figcaption>
                                        <p class="movie_title">해리포터</p>
                                        <p class="movie_content" >Lorem, ipsum dolor sit amet consectetur adipi. Maiores sapiente la, accusamus officiis at ea quibusdam dignissimos iure voluptatem quas eligendi quaerat nihil, incidunt omnis!</p>
                                        <p class="movie_genre">장르: 마법 판타지</p>
                                        <p class="movie_time">시간: 120분</p>
                                    </figcaption>
                                </figure>

                            </a>
                        </li>
                        <li>
                            <a href="movie_page.html">
                                <figure>
                                    <img src="/static/img/home.png" alt="" class="img_slide">
                                    <figcaption>
                                        <p class="movie_title">나홀로 집에</p>
                                        <p class="movie_content" >Lorem, ipsum dolor sit amet consectetur adipi. Maiores sapiente la, accusamus officiis at ea quibusdam dignissimos iure voluptatem quas eligendi quaerat nihil, incidunt omnis!</p>
                                        <p class="movie_genre">장르: 공포</p>
                                        <p class="movie_time">시간: 120분</p>
                                    </figcaption>
                                </figure>
   
                            </a>
                        </li>
                    </ul>

                
            </div>
            <div class="btn prev">
                <button class="prev">prev</button>
            </div>
            <div class="btn next">
                <button class="next">next</button>
            </div>
            
            <div class="ranking_no"><!-- 순위 등급 표시 태그 -->
    
            </div>
        </div>
    </div>

    <!-- ============================ 영화 랭킹 ============================= -->
    <!-- ============================ 평점 추천 ============================= -->
    <div class="star recommend">
        <div class="head">
            <h2>영화 별점 추천</h2>
        </div>
        <div class="movie_img">
            <ul class="movie_list">
                <li class="movie_list_poster" ><a href="movie_page.html"><img src="http://placehold.it/200X300" alt=""></a></li>
                <li class="movie_list_poster"><a href="movie_page.html"><img src="http://placehold.it/200X300" alt=""></a></li>
                <li class="movie_list_poster"><a href="movie_page.html"><img src="http://placehold.it/200X300" alt=""></a></li>
                <li class="movie_list_poster"><a href="movie_page.html"><img src="http://placehold.it/200X300" alt=""></a></li>
                <li class="movie_list_poster"><a href="movie_page.html"><img src="http://placehold.it/200X300" alt=""></a></li>
            </ul>

        </div>
    </div>
    <!-- ============================ 평점 추천 ============================= -->
    <!-- ============================ 시간대별 추천 ============================= -->
    <div class="time recommend">
        <div class="head" >
            <h2>
                시간대별 영화 추천
            </h2>
        </div>
        <div class="movie_img">
            <ul class="movie_list">
                <li class="movie_list_poster"><a href="movie_page.html"><img src="http://placehold.it/200X300" alt=""></a></li>
                <li class="movie_list_poster"><a href="movie_page.html"><img src="http://placehold.it/200X300" alt=""></a></li>
                <li class="movie_list_poster"><a href="movie_page.html"><img src="http://placehold.it/200X300" alt=""></a></li>
                <li class="movie_list_poster"><a href="movie_page.html"><img src="http://placehold.it/200X300" alt=""></a></li>
                <li class="movie_list_poster"><a href="movie_page.html"><img src="http://placehold.it/200X300" alt=""></a></li>
                
            </ul>

        </div>
    </div>
    <!-- ============================ 시간대별 추천 ============================= -->
    <!-- ============================ footer ============================= -->        
    <footer>

    </footer>
    <script src="/static/js/main.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function() {

            const urlParams = new URLSearchParams(window.location.search);
            const token = urlParams.get('token');
            const loginMethod = urlParams.get('loginMethod');
            if (token && loginMethod) {
                localStorage.setItem('accessToken', token);
                localStorage.setItem('loginMethod', loginMethod);
                window.history.replaceState({}, document.title, "/main"); // URL 클리닝
            }

            async function fetchMemberInfo() {
                try {
                    const accessToken = localStorage.getItem('accessToken') || localStorage.getItem('accessToken');
                    const loginMethod = localStorage.getItem('loginMethod');
                    let url = '/auth/memberinfo';

                    // 로그인 방식에 따라 엔드포인트 선택
                    // if (loginMethod === 'google') {
                    //     url = '/auth/google-memberinfo';
                    // }

                    const response = await fetch(url, {
                        method: 'GET',
                        headers: {
                            'Authorization': 'Bearer ' + accessToken
                        }
                    });

                    if (response.ok) {
                        const memberInfo = await response.json();
                        document.getElementById('member-info').innerText = '사용자 정보: ' + JSON.stringify(memberInfo);
                    } else {
                        document.getElementById('member-info').innerText = '사용자 정보를 가져오지 못했습니다.';
                    }
                } catch (error) {
                    console.error('Error fetching member info:', error);
                    document.getElementById('member-info').innerText = '오류가 발생했습니다.';
                }
            }

            // 페이지 로드 시 fetchMemberInfo 함수 호출
            fetchMemberInfo();
        });
    </script>

</body>
</html>